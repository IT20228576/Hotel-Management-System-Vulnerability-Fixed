const mongoose = require("mongoose");
const dotenv = require("dotenv");
const User = require("./models/userManagement/user.model");

/* Loading the environment variables from the .env file. */
dotenv.config();

/* Connecting to the MongoDB database. */
mongoose.connect(
  process.env.DBLINK,
  {
    useNewUrlParser: true,
    useUnifiedTopology: true,
  },
  (err) => {
    if (err) return console.error(err);
    console.log("Successfully Connected to MongoDB");
  }
);

/* Creating an array of admin objects. */
const seedAdmins = [
  {
    firstName: "Jane",
    lastName: "Smith",
    email: "jane.smith@email.com",
    dob: "1990-08-15",
    mobile: "555-123-4567",
    country: "vn",
    passwordHash:
      "$2a$10$kyDfuM.pQv/lbOQlyU.4Geycmv42dnN1O7nrGQku9kxrhwGd0dV9a", //123@Testing
    userType: "Admin",
  },
  {
    firstName: "Alice",
    lastName: "Smith",
    email: "alice.smith@example.com",
    dob: "1990-05-15",
    mobile: "555-123-4567",
    country: "tw",
    passwordHash:
      "$2a$10$kyDfuM.pQv/lbOQlyU.4Geycmv42dnN1O7nrGQku9kxrhwGd0dV9a", //123@Testing
    userType: "Admin",
  },
];

/**
 * Delete all users, then insert the seedAdmins array into the database.
 */
const seedDB = async () => {
  try {
    await User.deleteMany({ userType: "Admin" });
    await User.insertMany(seedAdmins);
    console.log("Successfully admins seeded to the database.");
  } catch (error) {
    console.error(error);
  }
};

seedDB().then(() => {
  mongoose.connection.close();
});
